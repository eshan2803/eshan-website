<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Commodity Transport Model | Eshan Singh</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js">document.getElementById('lcaForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const statusMessagesDiv = document.getElementById('statusMessages');
  const outputsDiv = document.getElementById('outputs');
  const downloadCsvButton = document.getElementById('downloadCsvButton');

  function logStatus(message) {
    const p = document.createElement('p');
    p.textContent = `> ${message}`;
    statusMessagesDiv.appendChild(p);
    statusMessagesDiv.scrollTop = statusMessagesDiv.scrollHeight;
  }

  function clearStatus() {
    statusMessagesDiv.innerHTML = '';
  }

  clearStatus();
  logStatus("Collecting user inputs...");

  const userInputs = {
    startLocation: document.getElementById('startLocation').value,
    endLocation: document.getElementById('endLocation').value,
    fuelType: parseInt(document.getElementById('fuelType').value),
    recirculationBOG: document.querySelector('input[name="bogTreatment"]:checked').value,
    bogRecirculationTruck: parseFloat(document.getElementById('bogRecirculationTruck').value),
    bogRecirculationTruckApply: document.getElementById('bogRecirculationTruckApply').value,
    bogRecirculationStorage: parseFloat(document.getElementById('bogRecirculationStorage').value),
    bogRecirculationStorageApply: document.getElementById('bogRecirculationStorageApply').value,
    bogRecirculationMaritime: parseFloat(document.getElementById('bogRecirculationMaritime').value),
    bogRecirculationMaritimeApply: document.getElementById('bogRecirculationMaritimeApply').value,
    storageTime: parseFloat(document.getElementById('storageTime').value),
    lh2PlantCapacity: parseFloat(document.getElementById('lh2PlantCapacity').value),
    shipTankVolume: parseFloat(document.getElementById('shipTankVolume').value),
    shipTankShape: document.getElementById('shipTankShape').value,
  };

  try {
    logStatus("Sending data to the Python server for calculation...");
    const response = await fetch('http://127.0.0.1:5000/calculate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(userInputs)
    });

    logStatus("Waiting for response from the server...");
    const results = await response.json();

    if (results.status === 'error') {
      throw new Error(results.message);
    }

    logStatus("Calculation complete. Displaying results...");
    // TODO: display results here
    outputsDiv.classList.remove('hidden');
  } catch (error) {
    logStatus(`Error: ${error.message}`);
    console.error("Calculation error:", error);
  }
});
</script>
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <style>
    body {
  font-family: 'Inter', sans-serif;
  margin: 0;
  background: #f5f5f4;
}



.header-left h1 {
  margin: 0;
  font-size: 2rem;
}

.header-left p {
  margin: 0.25rem 0 0;
  color: #4b5563;
}
    
    header h1 {
  margin: 0;
  font-size: 2rem;
}
    header p { margin: 0.25rem 0 0; color: #4b5563; }
    nav {
  display: flex;
  justify-content: center;
  gap: 2rem;
  background-color: rgba(56, 142, 60, 0.9);
  padding: 1rem 0;
}
    nav a {
  color: white;
  text-decoration: none;
  font-weight: 600;
  font-size: 1rem;
  transition: all 0.3s ease;
  position: relative;
}

nav a::after {
  content: "";
  position: absolute;
  width: 100%;
  height: 2px;
  bottom: -2px;
  left: 0;
  background-color: white;
  transform: scaleX(0);
  transform-origin: bottom right;
  transition: transform 0.25s ease-out;
}

nav a:hover::after {
  transform: scaleX(1);
  transform-origin: bottom left;
}
    nav a:hover {
  text-decoration: none;
}
    main.container { max-width: 960px; margin: auto; padding: 2rem; background: white; border-radius: 0.5rem; }
    .input-group { margin-bottom: 1.5rem; }
    .input-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
    .input-group input, .input-group select { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
    .input-inline { display: flex; align-items: center; gap: 0.5rem; }
    .button { background: #007BFF; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; font-weight: 600; }
    .button:hover { background: #0056b3; }
    .hidden { display: none; }
    footer { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; text-align: center; font-size: 0.875rem; color: #6b7280; }
    .social-links a { margin: 0 0.5rem; }
    .social-icon { width: 20px; height: 20px; }
  </style>
</head>
<body class="fade-in">
  <header style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem;">
  <div>
    <h1 style="font-size: 3rem; font-weight: 600; margin: 0;">Dr. Eshan Singh</h1>
  </div>
  <div class="header-animation">
    <lottie-player 
      src="assets/wind-turbine.json"
      background="transparent"
      speed="1"
      style="width: 150px; height: 150px;"
      loop autoplay>
    </lottie-player>
  </div>
</header>

  <nav>
    <a href="index.html">Home</a>
    <a href="energy.html">Energy Decarbonization</a>
    <a href="personal.html">Personal Musings</a>
    <a href="contact.html">Contact</a>
  </nav>

  <main class="container" style="background: rgba(255,255,255,0.92); border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); padding: 2rem; margin-top: 2rem;">
    <section>
      <h2>Commodity Transport Model</h2>
      <p>This tool allows you to calculate the energy usage, carbon footprint, and cost of transporting commodities across different global trade routes.</p>
      <form id="lcaForm">
        <div class="input-group">
          <label for="startLocation">Start Location</label>
          <input type="text" id="startLocation" value="Los Angeles, CA">
        </div>
        <div class="input-group">
          <label for="endLocation">End Location</label>
          <input type="text" id="endLocation" value="Rotterdam, Netherlands">
        </div>
        <div class="input-group">
          <label for="fuelType">Fuel Type</label>
          <select id="fuelType">
            <option value="0">Hydrogen</option>
            <option value="1">Ammonia</option>
            <option value="2">Methanol</option>
          </select>
        </div>
        <div class="input-group">
          <label>Boil-off Gas (BOG) Treatment</label>
          <div class="input-inline">
  <label style="display: flex; align-items: center; gap: 0.5rem;">
    <input type="radio" id="bogExpel" name="bogTreatment" value="1" checked> Expel
  </label>
  <label style="display: flex; align-items: center; gap: 0.5rem;">
    <input type="radio" id="bogRecirculation" name="bogTreatment" value="2"> Recirculation
  </label>
</div>
        </div>

        <div id="bogRecirculationDetails" class="hidden input-group" style="border: 1px solid #ccc; padding: 1rem; border-radius: 4px;">
  <h3 style="font-size: 1.1rem; margin-bottom: 1rem;">BOG Recirculation Details:</h3>
  <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
    <div>
      <label for="bogRecirculationTruck">In-land Transport Recirculation (%)</label>
      <input type="number" id="bogRecirculationTruck" value="80">
      <label for="bogRecirculationTruckApply">Use of BOG (In-land)</label>
      <select id="bogRecirculationTruckApply">
        <option value="1">Re-liquified</option>
        <option value="2">Used as another energy source</option>
      </select>
    </div>
    <div>
      <label for="bogRecirculationStorage">Storage Recirculation (%)</label>
      <input type="number" id="bogRecirculationStorage" value="80">
      <label for="bogRecirculationStorageApply">Use of BOG (Storage)</label>
      <select id="bogRecirculationStorageApply">
        <option value="1">Re-liquified</option>
        <option value="2">Used as another energy source</option>
      </select>
    </div>
    <div>
      <label for="bogRecirculationMaritime">Maritime Transport Recirculation (%)</label>
      <input type="number" id="bogRecirculationMaritime" value="80">
      <label for="bogRecirculationMaritimeApply">Use of BOG (Maritime)</label>
      <select id="bogRecirculationMaritimeApply">
        <option value="1">Re-liquified</option>
        <option value="2">Used as another energy source</option>
      </select>
    </div>
  </div>
</div>
          
        </div>

        <div class="input-group">
          <label for="storageTime">Storage Time at Port (days)</label>
          <input type="number" id="storageTime" value="3">
        </div>
        <div class="input-group">
          <label for="lh2PlantCapacity">LH2 Plant Capacity (kg/hr)</label>
          <input type="number" id="lh2PlantCapacity" value="1000">
        </div>
        <div class="input-group">
          <label for="shipTankVolume">Ship Tank Volume (mÂ³)</label>
          <input type="number" id="shipTankVolume" value="70000">
        </div>
        <div class="input-group">
          <label for="shipTankShape">Ship Tank Shape</label>
          <select id="shipTankShape">
            <option value="1">Capsule</option>
            <option value="2">Spherical</option>
          </select>
        </div>

        <div class="input-group">
          <button type="submit" class="button">Calculate</button>
        </div>
      </form>

      <div id="results" class="hidden" style="margin-top: 2rem;">
        <h3>Results</h3>
        <div id="map" style="height: 400px;"></div>
        <div id="outputTables"></div>
      </div>
    <div id="statusMessages" class="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-700 min-h-[50px]">Waiting for input...</div>
<div id="outputs" class="hidden">
  <h2 class="text-xl font-semibold mb-4 text-gray-700">Results</h2>
  <div id="map" class="mb-6 shadow-md" style="height: 400px;"></div>
  <h3 class="text-lg font-semibold mb-3 text-gray-600">Summary Metrics (per kg chemical):</h3>
  <div id="summaryTableContainer" class="table-container mb-6 shadow-md"><table id="summaryTable"></table></div>
  <h3 class="text-lg font-semibold mb-3 text-gray-600">Summary Metrics (per MJ):</h3>
  <div id="summaryTableContainer2" class="table-container mb-6 shadow-md"><table id="summaryTable2"></table></div>
  <h3 class="text-lg font-semibold mb-3 text-gray-600">Detailed Process Breakdown:</h3>
  <div id="detailedTableContainer" class="table-container mb-6 shadow-md"><table id="detailedTable"></table></div>
  <div class="text-center mt-6">
    <button id="downloadCsvButton" class="bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">Download Results (CSV)</button>
  </div>
</div>

<div id="messageModal" class="modal">
  <div class="modal-content">
    <p id="modalMessageText"></p>
    <button id="modalCloseButton" class="modal-close-button">OK</button>
  </div>
</div>
</section>
</main>

  <footer>
    <p>&copy; 2025 Eshan & Associates LLC. All rights reserved.</p>
    <div class="social-links">
      <a href="https://www.linkedin.com/in/eshan-singh-188b1554/" target="_blank">
        <img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/174/174857.png" alt="LinkedIn">
      </a>
      <a href="mailto:hello@eshansingh.xyz">
        <img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/732/732200.png" alt="Email">
      </a>
      <a href="https://scholar.google.com/citations?user=VhYa_v4AAAAJ&hl=en" target="_blank">
        <img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/2991/2991148.png" alt="Google Scholar">
      </a>
    </div>
  </footer>

  <script>
    document.getElementById('bogExpel').addEventListener('change', () => {
      document.getElementById('bogRecirculationDetails').classList.add('hidden');
    });
    document.getElementById('bogRecirculation').addEventListener('change', () => {
      document.getElementById('bogRecirculationDetails').classList.remove('hidden');
    });
  </script>
</body>
</html>
