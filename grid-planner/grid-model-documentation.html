<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Simulator Documentation | Dr. Eshan Singh</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        html { scroll-behavior: smooth; }
        body {
            background-color: #fcfcfc;
            font-family: 'Inter', sans-serif;
        }
        .font-lora { font-family: 'Lora', serif; }
        
        /* Rainbow Border Animation */
        @keyframes rainbow-border {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        .rainbow-glow {
            position: relative;
            background: linear-gradient(90deg, #ff0080, #ff8000, #ffff00, #80ff00, #00ff80, #0080ff, #8000ff, #ff0080);
            background-size: 200% 200%;
            animation: rainbow-border 2s linear infinite;
            padding: 2px;
            border-radius: 9999px;
        }
        
        .rainbow-glow .button-content {
            background: #f3f4f6;
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            display: block;
            color: #374151;
            font-size: 0.875rem;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .rainbow-glow:hover .button-content {
            background: #e5e7eb;
        }
        
        /* Glass Card Effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }
      
        /* Documentation specific styles */
        .documentation-content h3 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 0.5rem;
            color: #1f2937;
        }
        .documentation-content h4 {
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #3b82f6;
            font-weight: 600;
        }
        .documentation-content h5 {
            font-size: 1.1rem;
            margin-top: 1.25rem;
            margin-bottom: 0.5rem;
            color: #374151;
            font-weight: 600;
        }
        .documentation-content p, .documentation-content li {
            line-height: 1.7;
            text-align: justify;
            color: #4b5563;
        }
        .documentation-content ul, .documentation-content ol {
            padding-left: 1.5rem;
            margin-bottom: 1rem;
            list-style-type: disc;
        }
        .documentation-content ol li {
            margin-bottom: 0.75rem;
        }
        .documentation-content strong {
            color: #1f2937;
        }
        .documentation-content a {
            color: #3b82f6;
            text-decoration: none;
            font-weight: 500;
        }
        .documentation-content a:hover {
            text-decoration: underline;
        }
        .documentation-content code {
            background-color: rgba(59, 130, 246, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            color: #3b82f6;
        }
        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .parameter-table th, .parameter-table td {
            padding: 0.75rem 1rem;
            border: 1px solid rgba(59, 130, 246, 0.2);
            text-align: left;
        }
        .parameter-table th {
            background-color: #3b82f6;
            color: white;
            font-weight: 600;
        }
        .parameter-table tbody tr:nth-child(even) {
            background-color: rgba(59, 130, 246, 0.05);
        }
        .stacked-bar-container {
            position: relative;
            width: 100%;
            height: 24px;
            background-color: #e5e7eb;
            border-radius: 0.25rem;
            display: flex;
            overflow: hidden;
        }
        .stacked-bar-segment {
            height: 100%;
            transition: width 0.3s ease-in-out;
        }
        .tooltip {
            position: absolute;
            background-color: #1f2937;
            color: white;
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 10;
        }
        .chart-container {
            position: relative;
            height: 300px; /* Or any fixed height */
            width: 100%;
        }
    </style>
</head>
<body class="min-h-screen">
    
    <header class="p-8">
        <div class="container mx-auto flex justify-between items-center">
            <a href="/index.html" class="font-lora text-2xl font-semibold">Dr. Eshan Singh</a>
            <nav class="flex items-center space-x-2">
                <a href="/energy.html" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors">Articles</a>
                <a href="/transport-model/index.html" class="rainbow-glow">
                    <span class="button-content">Transport Model</span>
                </a>
                <a href="/grid-planner/index.html" class="rainbow-glow">
                     <span class="button-content">Grid Planner</span>
                </a>
                <a href="/grid-operator/index.html" class="rainbow-glow">
                     <span class="button-content">Grid Operator</span>
                </a>
                <a href="/musings.html" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors">Musings</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-8 pb-16">
        <div class="glass-card rounded-2xl p-8 shadow-xl">
            <section class="documentation-content">
                <h2 class="text-center text-4xl font-bold text-gray-800 mb-8 font-lora">Grid Simulator: Documentation</h2>

                <h3>1. Introduction</h3>
                <p>
                    The Grid Simulator is an educational tool designed to provide a simplified yet powerful look into the challenge of operating a modern electricity grid. It allows users to act as policymakers, adding new clean energy sources, energy storage, and other technologies to a baseline grid. The goal is to understand the complex trade-offs between cost, reliability, and emissions.
                </p>
                <p>
                    The model simulates a 24-hour period of grid operation, showing how different technologies work together to meet a fluctuating electricity demand. Users can immediately see the impact of their decisions on hourly generation, CO2 emissions, wholesale electricity prices, and key financial metrics that distinguish between consumer costs and total system costs. This documentation explains the core logic behind the simulation, including how resources are dispatched, how costs are calculated, and what key assumptions are made.
                </p>

                <h3>2. Key Features and Controls</h3>
                 <h4>2.1. Selecting a Scenario</h4>
                <p>
                    The first step is to choose a grid to simulate. You can select from a wide range of countries and regions using the dropdown menu. Each region comes with a pre-loaded grid mix, total capacity, and realistic seasonal peak demand values based on real-world data.
                </p>
                <p>
                    You can also select a <strong>Demand Profile</strong> for a specific season (e.g., Summer, Winter) and type (Typical vs. High). This allows you to test your grid against different conditions, from a normal spring day to an extreme summer heatwave. The model uses realistic, data-driven scaling to adjust the peak demand for each season and profile type.
                </p>
                
                <h4>2.2. Policy and Technology Levers</h4>
                <p>
                    The control panel on the right is where you make your decisions. The levers are divided into three main categories:
                </p>
                <ul>
                    <li><strong>Policy Levers:</strong> Here you can add new generating capacity (Solar, Wind, Nuclear, etc.) and energy storage. You can also deploy technologies like Demand Flexibility, which shifts some electricity use from peak to off-peak hours.</li>
                    <li><strong>Government Incentives:</strong> These levers allow you to simulate government policies. You can set a Carbon Tax, provide subsidies for clean energy (PTC) and storage (ITC), or set a price for exporting excess electricity.</li>
                    <li><strong>Direct Air Capture (DAC):</strong> This section allows you to deploy DAC technology, which actively removes CO2 from the atmosphere, and provide incentives for it.</li>
                </ul>
                
                <h4>2.3. Managing the Grid</h4>
                <ul>
                    <li><strong>Retiring Plants:</strong> In the "Installed Capacity Mix" chart, you can uncheck a box next to an energy source to simulate retiring that entire fleet of power plants.</li>
                    <li><strong>Customizing Profiles:</strong> You can click the "edit" icon next to the Demand or Capacity Factor profiles to manually adjust their hourly values, allowing you to create custom scenarios.</li>
                     <li><strong>Scenario Management:</strong> Use the Undo/Redo buttons to step through your changes. You can also set your current configuration as the new "Default" to compare future changes against it.</li>
                </ul>
                
                <h3>3. Methodology: How the Simulation Works</h3>
                <p>
                    The simulator operates on an hourly time-step over a 24-hour day. The core of the model is a <strong>dispatch algorithm</strong>, which decides which power plants should run in each hour to meet the electricity demand at the lowest possible cost while respecting the limitations of each technology. This process determines not only the generation mix but also the hourly <strong>marginal price</strong> of electricity.
                </p>

                <h4>3.1. The Dispatch Logic: A Step-by-Step Guide</h4>
                <p>
                    The model follows a sophisticated sequence to balance the grid each hour, closely mimicking how real-world markets operate.
                </p>
                <ol>
                    <li>
                        <strong>Calculate Net Load:</strong> The model first determines the hourly generation from "must-run" clean sources (Nuclear, Geothermal, Biomass) and "variable" renewables (Solar, Wind). This generation is subtracted from the total demand to calculate the <strong>Net Load</strong>â€”the remaining demand that must be met by flexible, dispatchable power plants.
                    </li>
                    <li>
                        <strong>Economic Battery Dispatch (Arbitrage):</strong> This is the most complex and realistic step. The model dispatches batteries based on economic signals to minimize costs. It performs an iterative loop:
                        <ul>
                            <li>It first calculates a 24-hour price forecast based on what it would cost for thermal plants (gas, coal) to meet the current net load.</li>
                            <li>It then checks if a profitable arbitrage opportunity exists. The model uses a realistic formula to determine profitability: <code>(Highest Price * 0.85) - Lowest Price > $20</code>. This means the potential revenue from selling power, after accounting for a 15% energy loss (85% round-trip efficiency), must be at least $20/MWh higher than the cost of buying power. This $20 threshold represents a "hurdle rate" to account for other operational costs like battery degradation.</li>
                            <li>If a profitable opportunity exists, the model dispatches a small "piece" of energy (0.1 GWh), charging the battery in the cheapest hour and discharging it in the most expensive hour. This dispatch is capped by the battery's power rating (GW) and its total energy capacity (GWh).</li>
                            <li>Crucially, it then recalculates the net load (which has changed due to the battery action) and the 24-hour price forecast, and then repeats the process. This loop continues until no more profitable trades are available.</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Strategic Hydro Dispatch:</strong> After storage has been dispatched, hydroelectric power is used. A portion is used as a steady "baseload" resource, while the rest is used flexibly to meet the highest remaining peaks in the net load.
                    </li>
                    <li>
                        <strong>Thermal Merit Order Dispatch & Marginal Pricing:</strong> If a deficit still remains, the model turns on the thermal power plants in a strict "merit order" from cheapest to most expensive. This is where the hourly price is set.
                        <ol type="a">
                            <li>First, cheaper and more efficient <strong>Combined-Cycle Gas Turbines (CCGT)</strong> are dispatched. The model assumes these plants have a variable cost that rises from $35/MWh to $80/MWh as more of the fleet is used.</li>
                            <li>Next, more expensive and less efficient "peaker" <strong>Combustion Turbines (CT)</strong> are used. These have a higher cost, from $100/MWh to $150/MWh.</li>
                            <li>Finally, <strong>Coal</strong> plants are dispatched as a last resort at a fixed cost.</li>
                        </ol>
                        The variable cost of the very last generator turned on in any given hour sets the <strong>Marginal Price</strong> for that hour. This price is what all generators are paid.
                    </li>
                    <li>
                        <strong>Curtailment and Exports:</strong> If, after all these steps, there is still an excess of renewable energy (a negative net load), that energy is "curtailed" (wasted). If an export price is set, this curtailed energy is sold, and the marginal price for that hour becomes the export price (which can be negative).
                    </li>
                </ol>
                
                <h4>3.2. Cost Calculation Framework</h4>
                <p>
                    The model calculates the total annual cost of running the grid. This is not just the fuel cost; it's a comprehensive calculation similar to a Levelized Cost of Energy (LCOE) analysis, which includes upfront construction costs, ongoing maintenance, and fuel.
                </p>
                <ul>
                    <li><strong>Capital Costs (CAPEX):</strong> This is the cost of building new power plants and storage facilities. Since a power plant lasts for many years (e.g., 30 for solar, 60 for nuclear), the model calculates an "annualized" cost, which is like a yearly mortgage payment for the plant. This is done using a Capital Recovery Factor (CRF) with a 7% discount rate (d). The formula is:
                        <br>
                        <code>CRF = (d * (1 + d)^n) / ((1 + d)^n - 1)</code>, where 'n' is the lifetime of the plant in years.
                    </li>
                    <li><strong>Fixed O&M Costs:</strong> These are the costs to keep a plant ready, even if it's not generating electricity (e.g., staff salaries, rent). This is calculated per kilowatt of capacity.</li>
                    <li><strong>Variable O&M Costs:</strong> These are the costs that depend on how much electricity is generated (e.g., fuel for natural gas plants, routine maintenance). This is calculated per megawatt-hour of generation. For natural gas, this cost is calculated based on the dispatch price of each plant type (CCGT vs. CT).</li>
                    <li><strong>Government Incentives:</strong> The model includes several policy levers that affect cost:
                        <ul>
                            <li><strong>Production Tax Credits (PTC):</strong> A subsidy ($/MWh) that reduces the operating cost of clean energy sources like solar and wind.</li>
                            <li><strong>Investment Tax Credits (ITC):</strong> A subsidy ($/kWh) that reduces the upfront construction (CAPEX) cost of energy storage.</li>
                            <li><strong>Carbon Tax:</strong> A fee ($/ton) applied to every ton of CO2 emitted by fossil fuel plants, making them more expensive to run.</li>
                        </ul>
                    </li>
                </ul>

                <h4>3.3. Financial Metrics Explained</h4>
                <p>The simulator presents two primary financial metrics to help you understand the economic trade-offs of your decisions. These metrics distinguish between the price consumers see and the overall cost to the system.</p>
                <ul>
                    <li>
                        <strong>Impact on Bill:</strong> This metric shows the percentage change in the <strong>demand-weighted average marginal price</strong> of electricity compared to a baseline scenario. In a real market, the marginal price sets the wholesale price for all electricity sold in a given hour. This metric calculates the average of those hourly prices, weighted by how much electricity was consumed, to provide a realistic estimate of the impact on consumer bills.
                        <br>
                        <code>Impact = ((New Avg. Price - Baseline Avg. Price) / Baseline Avg. Price) * 100%</code>
                    </li>
                    <li>
                        <strong>Change in System Cost:</strong> This metric shows the percentage change in the <strong>total annualized cost</strong> to build and operate the entire grid. It includes all capital, fixed, and variable costs, as well as taxes and subsidies. This metric represents the overall cost to the utility or society, which may be different from the immediate price impact seen by consumers.
                        <br>
                        <code>Change = ((New Annual Cost - Baseline Annual Cost) / Baseline Annual Cost) * 100%</code>
                    </li>
                </ul>
                <p>Below these main metrics, the model also calculates the <strong>Abatement Cost</strong>. This is the extra system cost required to avoid one ton of CO2 emissions. It is displayed alongside the total CO2 avoided to provide context on the cost-effectiveness of your decarbonization strategy.</p>

                <h3>4. Model Parameters and Assumptions</h3>
                <p>
                    The simulator uses a set of default parameters for costs, lifetimes, and emissions based on public data from sources like the National Renewable Energy Laboratory (NREL) and the U.S. Energy Information Administration (EIA).
                </p>

                <h4>4.1. Technology Cost and Lifetime Assumptions</h4>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Technology</th>
                            <th>Capital Cost (CAPEX) [$/kW]</th>
                            <th>Fixed O&M [$/kW-yr]</th>
                            <th>Variable O&M [$/MWh]</th>
                            <th>Lifetime [Years]</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Solar</td><td>1,200</td><td>15</td><td>0</td><td>30</td></tr>
                        <tr><td>Onshore Wind</td><td>1,500</td><td>35</td><td>1</td><td>30</td></tr>
                        <tr><td>Offshore Wind</td><td>5,000</td><td>100</td><td>0</td><td>30</td></tr>
                        <tr><td>Nuclear</td><td>7,242</td><td>140</td><td>10</td><td>60</td></tr>
                        <tr><td>Geothermal</td><td>3,329</td><td>120</td><td>5</td><td>30</td></tr>
                        <tr><td>Biomass</td><td>3,500</td><td>100</td><td>10</td><td>25</td></tr>
                        <tr><td>RNG (Biogas)</td><td>3,000</td><td>95</td><td>50</td><td>25</td></tr>
                        <tr><td>Natural Gas (CCGT)</td><td>1,300</td><td>20</td><td>$35 - $80</td><td>30</td></tr>
                        <tr><td>Natural Gas (CT)</td><td>1,300</td><td>20</td><td>$100 - $150</td><td>30</td></tr>
                        <tr><td>Coal</td><td>4,407</td><td>40</td><td>30</td><td>40</td></tr>
                        <tr><td>4-hr Battery</td><td>350 ($/kWh)</td><td>15</td><td>0</td><td>15</td></tr>
                        <tr><td>8-hr Battery</td><td>300 ($/kWh)</td><td>15</td><td>2</td><td>15</td></tr>
                        <tr><td>Long Duration Storage</td><td>300 ($/kWh)</td><td>60</td><td>1</td><td>25</td></tr>
                        <tr><td>Direct Air Capture</td><td>1000 ($/t/yr)</td><td>20 ($/t/yr)</td><td>400 ($/t)</td><td>25</td></tr>
                    </tbody>
                </table>
                <p><em>Note: Battery and DAC costs are based on their respective units (kWh and tons), not power capacity (kW). Natural Gas VOM represents a supply curve.</em></p>

                <h4>4.2. Emissions and Capacity Factors</h4>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Technology</th>
                            <th>CO2 Emission Factor [tons/GWh]</th>
                            <th>Capacity Factor (Average)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Coal</td><td>850</td><td>60%</td></tr>
                        <tr><td>Natural Gas</td><td>395</td><td>55%</td></tr>
                        <tr><td>Solar</td><td>0</td><td>~25% (Varies seasonally and hourly)</td></tr>
                        <tr><td>Onshore Wind</td><td>0</td><td>~35% (Varies seasonally and hourly)</td></tr>
                        <tr><td>Offshore Wind</td><td>0</td><td>~50% (Varies seasonally and hourly)</td></tr>
                        <tr><td>Nuclear</td><td>0</td><td>90%</td></tr>
                        <tr><td>Geothermal</td><td>0</td><td>90%</td></tr>
                        <tr><td>Biomass</td><td>0</td><td>85%</td></tr>
                        <tr><td>RNG (Biogas)</td><td>0</td><td>85%</td></tr>
                        <tr><td>Hydro</td><td>0</td><td>~45% (Varies seasonally)</td></tr>
                    </tbody>
                </table>
                 <p>
                    <strong>Capacity Factor</strong> is the ratio of the actual electricity produced by a plant over a period to the maximum possible electricity it could have produced. For example, a solar plant can only generate power when the sun is shining, so its capacity factor is much lower than a nuclear plant that can run 24/7. The model uses realistic hourly profiles for solar and wind, and seasonal averages for hydro.
                </p>

                <h3>5. Regional and Seasonal Assumptions</h3>
                <p>The simulator's baseline scenarios are built on a foundation of real-world data, projected to 2025 where possible. This section details the key data points and scaling factors used to create realistic and distinct scenarios for each region and season.</p>

                <h4>5.1. Regional Grid Data (2025 Projections)</h4>
                <p>The following table outlines the baseline total installed capacity, the percentage mix of different generation sources, and the utility-scale battery storage capacity for each region in the model. These figures are based on the latest available data from national energy agencies and international reports.</p>
                <div id="grid-mix-legend" class="flex flex-wrap justify-center gap-x-4 gap-y-2 my-4"></div>
                <table class="parameter-table" id="grid-mix-table">
                    <thead>
                        <tr>
                            <th>Region</th>
                            <th>Total Capacity (GW)</th>
                            <th class="w-1/3">Grid Mix</th>
                            <th>Battery Capacity (GWh)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be dynamically inserted here by JavaScript -->
                    </tbody>
                </table>
                <div id="tooltip" class="tooltip"></div>

                <h4>5.2. Seasonal Profile Scaling</h4>
                <p>To simulate different conditions, the model adjusts the baseline demand and renewable generation profiles based on the selected season. This ensures that a "Summer High" scenario feels different and presents different challenges than a "Winter Typical" one.</p>
                
                <h5>Demand Profile Scaling</h5>
                <p>The model starts with a set of standardized 24-hour demand curve shapes for each season. To make these specific to a region, it scales the entire curve up or down to match the region's known peak demand for that season. For "Typical" days, the peak is scaled down from the "High" (record) peak using the following factors:</p>
                <table class="parameter-table">
                    <thead><tr><th>Season</th><th>Typical Day Scaling Factor</th></tr></thead>
                    <tbody>
                        <tr><td>Spring</td><td>79% of High Peak</td></tr>
                        <tr><td>Summer</td><td>82% of High Peak</td></tr>
                        <tr><td>Fall</td><td>77% of High Peak</td></tr>
                        <tr><td>Winter</td><td>73% of High Peak</td></tr>
                    </tbody>
                </table>
                
                <h5>Regional High Peak Loads</h5>
                <p>The following table shows the "High" peak load in Gigawatts (GW) for each region and season, which the demand profiles are scaled to match.</p>
                <table class="parameter-table" id="peak-load-table">
                     <thead>
                        <tr>
                            <th>Region</th>
                            <th>Spring Peak (GW)</th>
                            <th>Summer Peak (GW)</th>
                            <th>Fall Peak (GW)</th>
                            <th>Winter Peak (GW)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be dynamically inserted here by JavaScript -->
                    </tbody>
                </table>

                <h5>Baseline High Demand Profiles</h5>
                <p>These charts show the shape of the "High" demand curve for each season before it is scaled to a specific region's peak load.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-4">
                    <div class="chart-container"><canvas id="springDemandChart"></canvas></div>
                    <div class="chart-container"><canvas id="summerDemandChart"></canvas></div>
                    <div class="chart-container"><canvas id="fallDemandChart"></canvas></div>
                    <div class="chart-container"><canvas id="winterDemandChart"></canvas></div>
                </div>

                <h5>Renewable Capacity Factor Scaling</h5>
                <p>The generation from solar and wind varies significantly with the seasons. The model accounts for this by applying multipliers to the baseline hourly capacity factor profiles. For example, wind output is higher in the winter, while solar output is higher in the summer.</p>
                
                <h5>Baseline Renewable Capacity Factor Profiles</h5>
                <p>This chart shows the default 24-hour capacity factor profile for each variable renewable technology before any seasonal multipliers are applied.</p>
                <div class="mt-4 chart-container">
                     <canvas id="baselineCFChart"></canvas>
                </div>

                <table class="parameter-table mt-8">
                    <thead>
                        <tr>
                            <th>Season</th>
                            <th>Solar Multiplier</th>
                            <th>Onshore Wind Multiplier</th>
                            <th>Offshore Wind Multiplier</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Spring</td><td>1.0x</td><td>1.0x</td><td>1.0x</td></tr>
                        <tr><td>Summer</td><td>1.1x</td><td>0.8x</td><td>0.9x</td></tr>
                        <tr><td>Fall</td><td>0.8x</td><td>1.0x</td><td>1.0x</td></tr>
                        <tr><td>Winter</td><td>0.6x</td><td>1.1x</td><td>1.1x</td></tr>
                    </tbody>
                </table>
                <h3>6. Model Limitations and Assumptions</h3>
                <p>
                    Transparency is key to understanding the simulator's results. While powerful, the model is a simplification of a real-world grid and has several important limitations:
                </p>
                <ul>
                    <li><strong>Single-Day Simulation:</strong> The model simulates a single, representative 24-hour period for a given season. It does not capture seasonal variations, long-term weather patterns, or multi-day storage dynamics (often called "seasonal storage").</li>
                    <li><strong>No Transmission Constraints:</strong> The model assumes a "copper plate" grid, meaning there are no bottlenecks or congestion in the transmission network. In reality, getting power from where it's generated to where it's needed is a major challenge and cost.</li>
                    <li><strong>Simplified Market Dynamics:</strong> The simulation uses a realistic marginal pricing and economic dispatch model but does not include more complex market products like ancillary services (e.g., frequency regulation) or capacity markets, which are additional revenue streams for generators and storage.</li>
                    <li><strong>Perfect Foresight:</strong> The model knows the demand and renewable generation for all 24 hours in advance, allowing it to optimize perfectly. Real-world grid operators must contend with uncertainty and forecasting errors.</li>
                    <li><strong>Generic Cost Data:</strong> The capital and operational costs are based on regional or national averages (primarily from U.S. sources like NREL and EIA) and do not capture all local site-specific cost variations.</li>
                </ul>
            </section>
        </div>
    </main>

    <footer class="w-full text-center py-5 border-t border-gray-200/80">
        <div class="flex items-center justify-center space-x-4">
             <p class="text-sm text-gray-500">&copy; 2025 Eshan & Associates LLC. All rights reserved.</p>
             <a href="https://www.linkedin.com/in/eshan-singh-188b1554/" target="_blank" rel="noopener noreferrer" class="cursor-pointer">
                <img src="https://cdn-icons-png.flaticon.com/512/174/174857.png" alt="LinkedIn" class="h-5 w-5 hover:opacity-75 transition-opacity">
            </a>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const countryGridMixData = {
                "California": { totalCapacityMW: 89223, peakLoadsMW: { summer: 52061, winter: 47500, fall: 46000, spring: 41000 }, mix: { coal: 0.1, naturalGas: 43.4, hydro: 15.7, wind: 7.1, offshoreWind: 0, solar: 26.1, nuclear: 2.7, geothermal: 3.0, biomass: 1.0 , rng: 0.4}, storageGWh: { battery4hr: 53.0 } },
                "China": { totalCapacityMW: 3400000, peakLoadsMW: { summer: 1340000, winter: 1206000, fall: 1179200, spring: 1072000 }, mix: { coal: 40.0, naturalGas: 8.0, hydro: 12.5, wind: 14.0, offshoreWind: 1.6, solar: 20.0, nuclear: 2.5, geothermal: 0.1, biomass: 0.9 , rng: 0.4}, storageGWh: { battery4hr: 132.0 } },
                "United States": { totalCapacityMW: 1275000, peakLoadsMW: { summer: 800000, winter: 720000, fall: 704000, spring: 640000 }, mix: { coal: 15.0, naturalGas: 48.0, hydro: 7.8, wind: 11.5, offshoreWind: 0.2, solar: 9.0, nuclear: 8.0, geothermal: 0.3, biomass: 0.8 , rng: 0.4}, storageGWh: { battery4hr: 72.8 } },
                "India": { totalCapacityMW: 476000, peakLoadsMW: { summer: 243000, winter: 206550, fall: 213840, spring: 194400 }, mix: { coal: 50.0, naturalGas: 6.0, hydro: 10.0, wind: 9.5, offshoreWind: 0, solar: 18.0, nuclear: 1.8, geothermal: 0.0, biomass: 1.9 , rng: 0.8}, storageGWh: { battery4hr: 4.0 } },
                "Japan": { totalCapacityMW: 295000, peakLoadsMW: { summer: 181000, winter: 162900, fall: 159280, spring: 144800 }, mix: { coal: 20.0, naturalGas: 35.0, hydro: 17.0, wind: 1.6, offshoreWind: 0.1, solar: 15.5, nuclear: 10.5, geothermal: 0.2, biomass: 1.1 , rng: 0.5}, storageGWh: { battery4hr: 3.0 } },
                "Russia": { totalCapacityMW: 248000, peakLoadsMW: { winter: 160000, summer: 144000, fall: 140800, spring: 128000 }, mix: { coal: 15.0, naturalGas: 52.0, hydro: 20.0, wind: 0.9, offshoreWind: 0, solar: 0.8, nuclear: 11.3, geothermal: 0.0, biomass: 0.1 , rng: 0.1} },
                "Brazil": { totalCapacityMW: 180000, peakLoadsMW: { summer: 101860, winter: 91674, fall: 89637, spring: 81488 }, mix: { coal: 2.0, naturalGas: 18.0, hydro: 59.0, wind: 10.5, offshoreWind: 0, solar: 9.5, nuclear: 1.0, geothermal: 0.0, biomass: 5.6 , rng: 2.4} },
                "Germany": { totalCapacityMW: 210000, peakLoadsMW: { winter: 84000, summer: 75600, fall: 73920, spring: 67200 }, mix: { coal: 14.0, naturalGas: 38.0, hydro: 4.0, wind: 22.0, offshoreWind: 4.0, solar: 12.0, nuclear: 5.0, geothermal: 0.0, biomass: 4.2 , rng: 1.8}, storageGWh: { battery4hr: 12.0 } },
                "Canada": { totalCapacityMW: 165000, peakLoadsMW: { winter: 140000, summer: 126000, fall: 123200, spring: 112000 }, mix: { coal: 4.5, naturalGas: 13.5, hydro: 57.0, wind: 8.5, offshoreWind: 0, solar: 2.5, nuclear: 14.0, geothermal: 0.0, biomass: 1.4 , rng: 0.6}, storageGWh: { battery4hr: 1.0 } },
                "South Korea": { totalCapacityMW: 125000, peakLoadsMW: { summer: 93000, winter: 83700, fall: 81840, spring: 74400 }, mix: { coal: 34.0, naturalGas: 20.0, hydro: 5.0, wind: 1.4, offshoreWind: 0.1, solar: 12.5, nuclear: 27.0, geothermal: 0.0, biomass: 0.7 , rng: 0.3} },
                "France": { totalCapacityMW: 115000, peakLoadsMW: { winter: 102000, summer: 91800, fall: 89760, spring: 81600 }, mix: { coal: 1.0, naturalGas: 10.0, hydro: 10.0, wind: 8.0, offshoreWind: 0.5, solar: 6.0, nuclear: 64.0, geothermal: 0.0, biomass: 0.3 , rng: 0.1} },
                "United Kingdom": { totalCapacityMW: 78000, peakLoadsMW: { winter: 60000, summer: 54000, fall: 52800, spring: 48000 }, mix: { coal: 1.0, naturalGas: 38.0, hydro: 2.0, wind: 15.0, offshoreWind: 14.0, solar: 19.0, nuclear: 9.0, geothermal: 0.0, biomass: 4.2 , rng: 1.8}, storageGWh: { battery4hr: 16.0 } },
                "Australia": { totalCapacityMW: 65000, peakLoadsMW: { summer: 47000, winter: 42300, fall: 41360, spring: 37600 }, mix: { coal: 45.0, naturalGas: 18.0, hydro: 13.0, wind: 10.0, offshoreWind: 0, solar: 13.0, nuclear: 0.0, geothermal: 0.0, biomass: 0.7 , rng: 0.3}, storageGWh: { battery4hr: 5.0 } },
                "Spain": { totalCapacityMW: 120000, peakLoadsMW: { summer: 45000, winter: 40500, fall: 39600, spring: 36000 }, mix: { coal: 2.0, naturalGas: 22.0, hydro: 17.0, wind: 27.5, offshoreWind: 0, solar: 21.5, nuclear: 7.0, geothermal: 0.0, biomass: 1.0 , rng: 0.4} },
                "Italy": { totalCapacityMW: 122000, peakLoadsMW: { summer: 60000, winter: 54000, fall: 52800, spring: 48000 }, mix: { coal: 4.0, naturalGas: 47.0, hydro: 18.0, wind: 10.0, offshoreWind: 0, solar: 19.0, nuclear: 0.0, geothermal: 1.0, biomass: 1.4 , rng: 0.6} },
                "Indonesia": { totalCapacityMW: 75000, peakLoadsMW: { summer: 50000, winter: 45000, fall: 44000, spring: 40000 }, mix: { coal: 48.0, naturalGas: 28.0, hydro: 9.0, wind: 0.2, offshoreWind: 0, solar: 2.8, nuclear: 0.0, geothermal: 3.0, biomass: 0.7 , rng: 0.3} },
                "South Africa": { totalCapacityMW: 60000, peakLoadsMW: { winter: 34000, summer: 30600, fall: 29920, spring: 27200 }, mix: { coal: 78.0, naturalGas: 6.0, hydro: 6.0, wind: 5.5, offshoreWind: 0, solar: 3.5, nuclear: 0.0, geothermal: 0.0, biomass: 0.3 , rng: 0.1} },
                "Mexico": { totalCapacityMW: 88000, peakLoadsMW: { summer: 50000, winter: 45000, fall: 44000, spring: 40000 }, mix: { coal: 5.0, naturalGas: 58.0, hydro: 15.0, wind: 9.0, offshoreWind: 0, solar: 11.0, nuclear: 1.0, geothermal: 1.0, biomass: 0.3 , rng: 0.1} },
                "Norway": { totalCapacityMW: 39000, peakLoadsMW: { winter: 25000, summer: 22500, fall: 22000, spring: 20000 }, mix: { coal: 0.0, naturalGas: 0.0, hydro: 91.0, wind: 8.5, offshoreWind: 0, solar: 0.5, nuclear: 0.0, geothermal: 0.0, biomass: 0.0 , rng: 0.0} },
                "New Zealand": { totalCapacityMW: 9800, peakLoadsMW: { winter: 7000, summer: 6300, fall: 6160, spring: 5600 }, mix: { coal: 0.0, naturalGas: 14.0, hydro: 56.0, wind: 7.5, offshoreWind: 0, solar: 1.5, nuclear: 0.0, geothermal: 20.0, biomass: 0.7 , rng: 0.3} },
                "Vietnam": { totalCapacityMW: 80000, peakLoadsMW: { summer: 45000, winter: 40500, fall: 39600, spring: 36000 }, mix: { coal: 32.0, naturalGas: 9.0, hydro: 28.0, wind: 6.0, offshoreWind: 0, solar: 24.0, nuclear: 0.0, geothermal: 0.0, biomass: 0.7 , rng: 0.3} }
            };

            const COLORS = {
                coal: 'rgba(0, 0, 0, 0.8)', naturalGas: 'rgba(107, 114, 128, 0.8)', hydro: 'rgba(59, 130, 246, 0.8)',
                nuclear: 'rgba(239, 68, 68, 0.8)', solar: 'rgba(251, 191, 36, 1)',
                wind: 'rgba(16, 185, 129, 0.8)', offshoreWind: 'rgba(12, 148, 103, 0.8)',
                geothermal: 'rgba(120, 40, 40, 0.8)', biomass: 'rgba(101, 67, 33, 0.8)', rng: 'rgba(132, 204, 22, 0.8)'
            };

            const techOrder = ['coal', 'naturalGas', 'hydro', 'nuclear', 'solar', 'wind', 'offshoreWind', 'geothermal', 'biomass', 'rng'];

            // --- Grid Mix Table ---
            const tableBody = document.getElementById('grid-mix-table').querySelector('tbody');
            const legendContainer = document.getElementById('grid-mix-legend');
            const tooltip = document.getElementById('tooltip');

            techOrder.forEach(tech => {
                let name = tech.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                if (tech === 'wind') name = 'Onshore Wind';
                if (tech === 'offshoreWind') name = 'Offshore Wind';
                if (tech === 'rng') name = 'RNG (Biogas)';
                const legendItem = document.createElement('div');
                legendItem.className = 'flex items-center';
                legendItem.innerHTML = `<div class="w-4 h-4 mr-2 rounded" style="background-color: ${COLORS[tech]}"></div><span>${name}</span>`;
                legendContainer.appendChild(legendItem);
            });

            for (const country in countryGridMixData) {
                const data = countryGridMixData[country];
                const row = tableBody.insertRow();
                
                row.insertCell().textContent = country;
                row.insertCell().textContent = (data.totalCapacityMW / 1000).toLocaleString(undefined, {maximumFractionDigits: 1});
                
                const barCell = row.insertCell();
                const barContainer = document.createElement('div');
                barContainer.className = 'stacked-bar-container';
                
                let tooltipContent = '';
                techOrder.forEach(tech => {
                    const percentage = data.mix[tech] || 0;
                    if (percentage > 0) {
                        const segment = document.createElement('div');
                        segment.className = 'stacked-bar-segment';
                        segment.style.width = `${percentage}%`;
                        segment.style.backgroundColor = COLORS[tech];
                        barContainer.appendChild(segment);
                        let name = tech.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                        if (tech === 'wind') name = 'Onshore Wind';
                        if (tech === 'offshoreWind') name = 'Offshore Wind';
                        if (tech === 'rng') name = 'RNG (Biogas)';
                        tooltipContent += `<div class="flex justify-between w-full"><span class="font-bold mr-2">${name}:</span><span>${percentage.toFixed(1)}%</span></div>`;
                    }
                });
                barContainer.dataset.tooltip = tooltipContent;
                barCell.appendChild(barContainer);

                row.insertCell().textContent = data.storageGWh ? (data.storageGWh.battery4hr || 0).toLocaleString(undefined, {maximumFractionDigits: 1}) : '0.0';
            }

            document.querySelectorAll('.stacked-bar-container').forEach(bar => {
                bar.addEventListener('mousemove', function(e) {
                    tooltip.innerHTML = this.dataset.tooltip;
                    tooltip.style.opacity = '1';
                    tooltip.style.left = `${e.pageX + 10}px`;
                    tooltip.style.top = `${e.pageY + 10}px`;
                });
                bar.addEventListener('mouseleave', function() {
                    tooltip.style.opacity = '0';
                });
            });

             // --- Peak Load Table ---
            const peakLoadTableBody = document.getElementById('peak-load-table').querySelector('tbody');
            for (const country in countryGridMixData) {
                const data = countryGridMixData[country];
                const row = peakLoadTableBody.insertRow();
                row.insertCell().textContent = country;
                row.insertCell().textContent = (data.peakLoadsMW.spring / 1000).toLocaleString(undefined, {maximumFractionDigits: 1});
                row.insertCell().textContent = (data.peakLoadsMW.summer / 1000).toLocaleString(undefined, {maximumFractionDigits: 1});
                row.insertCell().textContent = (data.peakLoadsMW.fall / 1000).toLocaleString(undefined, {maximumFractionDigits: 1});
                row.insertCell().textContent = (data.peakLoadsMW.winter / 1000).toLocaleString(undefined, {maximumFractionDigits: 1});
            }

            // --- Demand and CF Charts ---
            const HOURS = Array.from({ length: 24 }, (_, i) => `${i}:00`);
            const SEASONAL_DEMAND_PROFILES = {
                'spring-high': [28, 26, 25, 24, 24, 25, 28, 32, 33, 32, 30, 28, 27, 28, 30, 34, 39, 45, 48, 46, 42, 38, 34, 30],
                'summer-high': [30, 28, 27, 26, 26, 27, 29, 33, 37, 40, 42, 44, 46, 48, 50, 52, 55, 56, 55, 52, 48, 43, 38, 33],
                'fall-high': [27, 25, 24, 23, 23, 24, 27, 31, 34, 36, 37, 38, 39, 40, 41, 43, 46, 50, 49, 46, 42, 37, 32, 29],
                'winter-high': [32, 30, 29, 29, 30, 34, 40, 45, 44, 42, 40, 39, 39, 40, 41, 43, 45, 46, 45, 42, 39, 36, 34, 32]
            };
            const SOLAR_CF_PROFILE = [0,0,0,0,0,0.05,0.15,0.3,0.5,0.7,0.8,0.85,0.9,0.85,0.8,0.7,0.3,0.05,0,0,0,0,0,0];
            const WIND_CF_PROFILE = [0.4,0.42,0.45,0.46,0.45,0.4,0.35,0.3,0.25,0.2,0.2,0.2,0.25,0.3,0.35,0.4,0.5,0.6,0.65,0.6,0.55,0.5,0.45,0.4];
            const OFFSHORE_WIND_CF_PROFILE = [0.55,0.56,0.57,0.58,0.58,0.57,0.55,0.52,0.5,0.48,0.47,0.46,0.47,0.48,0.5,0.52,0.55,0.6,0.62,0.61,0.6,0.58,0.57,0.56];

            const createLineChart = (canvasId, datasets, title) => {
                const canvas = document.getElementById(canvasId);
                if (canvas) {
                    new Chart(canvas, {
                        type: 'line',
                        data: { labels: HOURS, datasets: datasets },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { 
                                legend: { display: datasets.length > 1 },
                                title: { display: !!title, text: title, font: { size: 16, family: 'Lora' } }
                            },
                            scales: { y: { beginAtZero: true, ticks: { callback: (value) => canvasId.includes('Demand') ? value : `${Math.round(value * 100)}%` } } }
                        }
                    });
                }
            };

            createLineChart('springDemandChart', [{ label: 'Demand (GW)', data: SEASONAL_DEMAND_PROFILES['spring-high'], borderColor: '#10b981', tension: 0.3, fill: true, backgroundColor: 'rgba(16, 185, 129, 0.1)' }], 'Spring High Demand');
            createLineChart('summerDemandChart', [{ label: 'Demand (GW)', data: SEASONAL_DEMAND_PROFILES['summer-high'], borderColor: '#ef4444', tension: 0.3, fill: true, backgroundColor: 'rgba(239, 68, 68, 0.1)' }], 'Summer High Demand');
            createLineChart('fallDemandChart', [{ label: 'Demand (GW)', data: SEASONAL_DEMAND_PROFILES['fall-high'], borderColor: '#f97316', tension: 0.3, fill: true, backgroundColor: 'rgba(249, 115, 22, 0.1)' }], 'Fall High Demand');
            createLineChart('winterDemandChart', [{ label: 'Demand (GW)', data: SEASONAL_DEMAND_PROFILES['winter-high'], borderColor: '#0ea5e9', tension: 0.3, fill: true, backgroundColor: 'rgba(14, 165, 233, 0.1)' }], 'Winter High Demand');
            
            createLineChart('baselineCFChart', [
                { label: 'Solar', data: SOLAR_CF_PROFILE, borderColor: COLORS.solar, tension: 0.3 },
                { label: 'Onshore Wind', data: WIND_CF_PROFILE, borderColor: COLORS.wind, tension: 0.3 },
                { label: 'Offshore Wind', data: OFFSHORE_WIND_CF_PROFILE, borderColor: COLORS.offshoreWind, tension: 0.3 }
            ]);
        });
    </script>

</body>
</ht



